import nltk
from nltk.corpus import stopwords
nltk.download('stopwords')
import pandas as pd
import re
import ast
import string

df = pd.read_csv(r'D:\master\data science\semestre 4\M2.979 - tfm\data\raw_influencers_test.csv', encoding='utf-8')

# Remove commas from 'content' field
df['content'] = df['content'].apply(lambda x: ''.join([i for i in x if i not in ',']))
df.to_csv(r'D:\master\data science\semestre 4\M2.979 - tfm\data\raw_influencers_test_00.csv', index=False, header=True)

# Hashtag extraction using regex (generates a new column names 'hashtag' with the list of hashtags, but it does not remove the hashtags from the 'content')
# https://towardsdatascience.com/basic-tweet-preprocessing-in-python-efd8360d529e
df['hashtag'] = df['content'].apply(lambda x: re.findall(r'#(\w+)', x))
df.to_csv(r'D:\master\data science\semestre 4\M2.979 - tfm\data\raw_influencers_test_01.csv', index=False, header=True)

# -----






# Remove emojis
# https://towardsdatascience.com/basic-tweet-preprocessing-in-python-efd8360d529e
#emojis = {'\xf0\x9f\x8d\x80','\xf0\x9f\x8d\x81','\xf0\x9f\x8d\x82','\xf0\x9f\x8d\x83','\xf0\x9f\x8d\x84','\xf0\x9f\x8d\x85','\xf0\x9f\x8d\x86','\xf0\x9f\x8d\x87','\xf0\x9f\x8d\x88','\xf0\x9f\x8d\x89','\xf0\x9f\x8d\x8a','\xf0\x9f\x8d\x8b','\xf0\x9f\x8d\x8c','\xf0\x9f\x8d\x8d','\xf0\x9f\x8d\x8e','\xf0\x9f\x8d\x8f','\xf0\x9f\x8d\x90','\xf0\x9f\x8d\x91','\xf0\x9f\x8d\x92','\xf0\x9f\x8d\x93','\xf0\x9f\x8d\x94','\xf0\x9f\x8d\x95','\xf0\x9f\x8d\x96','\xf0\x9f\x8d\x97','\xf0\x9f\x8d\x98','\xf0\x9f\x8d\x99','\xf0\x9f\x8d\x9a','\xf0\x9f\x8d\x9b','\xf0\x9f\x8d\x9c','\xf0\x9f\x8d\x9d','\xf0\x9f\x8d\x9e','\xf0\x9f\x8d\x9f','\xf0\x9f\x8d\xa0','\xf0\x9f\x8d\xa1','\xf0\x9f\x8d\xa2','\xf0\x9f\x8d\xa3','\xf0\x9f\x8d\xa4','\xf0\x9f\x8d\xa5','\xf0\x9f\x8d\xa6','\xf0\x9f\x8d\xa7','\xf0\x9f\x8d\xa8','\xf0\x9f\x8d\xa9','\xf0\x9f\x8d\xaa','\xf0\x9f\x8d\xab','\xf0\x9f\x8d\xac','\xf0\x9f\x8d\xad','\xf0\x9f\x8d\xae','\xf0\x9f\x8d\xaf','\xf0\x9f\x8d\xb0','\xf0\x9f\x8d\xb1','\xf0\x9f\x8d\xb2','\xf0\x9f\x8d\xb3','\xf0\x9f\x8d\xb4','\xf0\x9f\x8d\xb5','\xf0\x9f\x8d\xb6','\xf0\x9f\x8d\xb7','\xf0\x9f\x8d\xb8','\xf0\x9f\x8d\xb9','\xf0\x9f\x8d\xba','\xf0\x9f\x8d\xbb','\xf0\x9f\x8d\xbc','\xf0\x9f\x8d\xbd','\xf0\x9f\x8d\xbe','\xf0\x9f\x8d\xbf','\xf0\x9f\x8e\x80','\xf0\x9f\x8e\x81','\xf0\x9f\x8e\x82','\xf0\x9f\x8e\x83','\xf0\x9f\x8e\x84','\xf0\x9f\x8e\x85','\xf0\x9f\x8e\x86','\xf0\x9f\x8e\x87','\xf0\x9f\x8e\x88','\xf0\x9f\x8e\x89','\xf0\x9f\x8e\x8a','\xf0\x9f\x8e\x8b','\xf0\x9f\x8e\x8c','\xf0\x9f\x8e\x8d','\xf0\x9f\x8e\x8e','\xf0\x9f\x8e\x8f','\xf0\x9f\x8e\x90','\xf0\x9f\x8e\x91','\xf0\x9f\x8e\x92','\xf0\x9f\x8e\x93','\xf0\x9f\x8e\x94','\xf0\x9f\x8e\x95','\xf0\x9f\x8e\x96','\xf0\x9f\x8e\x97','\xf0\x9f\x8e\x98','\xf0\x9f\x8e\x99','\xf0\x9f\x8e\x9a','\xf0\x9f\x8e\x9b','\xf0\x9f\x8e\x9c','\xf0\x9f\x8e\x9d','\xf0\x9f\x8e\x9e','\xf0\x9f\x8e\x9f','\xf0\x9f\x8e\xa0','\xf0\x9f\x8e\xa1','\xf0\x9f\x8e\xa2','\xf0\x9f\x8e\xa3','\xf0\x9f\x8e\xa4','\xf0\x9f\x8e\xa5','\xf0\x9f\x8e\xa6','\xf0\x9f\x8e\xa7','\xf0\x9f\x8e\xa8','\xf0\x9f\x8e\xa9','\xf0\x9f\x8e\xaa','\xf0\x9f\x8e\xab','\xf0\x9f\x8e\xac','\xf0\x9f\x8e\xad','\xf0\x9f\x8e\xae','\xf0\x9f\x8e\xaf','\xf0\x9f\x8e\xb0','\xf0\x9f\x8e\xb1','\xf0\x9f\x8e\xb2','\xf0\x9f\x8e\xb3','\xf0\x9f\x8e\xb4','\xf0\x9f\x8e\xb5','\xf0\x9f\x8e\xb6','\xf0\x9f\x8e\xb7','\xf0\x9f\x8e\xb8','\xf0\x9f\x8e\xb9','\xf0\x9f\x8e\xba','\xf0\x9f\x8e\xbb','\xf0\x9f\x8e\xbc','\xf0\x9f\x8e\xbd','\xf0\x9f\x8e\xbe','\xf0\x9f\x8e\xbf','\xf0\x9f\x8f\x80','\xf0\x9f\x8f\x81','\xf0\x9f\x8f\x82','\xf0\x9f\x8f\x83','\xf0\x9f\x8f\x84','\xf0\x9f\x8f\x85','\xf0\x9f\x8f\x86','\xf0\x9f\x8f\x87','\xf0\x9f\x8f\x88','\xf0\x9f\x8f\x89','\xf0\x9f\x8f\x8a','\xf0\x9f\x8f\x8b','\xf0\x9f\x8f\x8c','\xf0\x9f\x8f\x8d','\xf0\x9f\x8f\x8e','\xf0\x9f\x8f\x8f','\xf0\x9f\x8f\x90','\xf0\x9f\x8f\x91','\xf0\x9f\x8f\x92','\xf0\x9f\x8f\x93','\xf0\x9f\x8f\x94','\xf0\x9f\x8f\x95','\xf0\x9f\x8f\x96','\xf0\x9f\x8f\x97','\xf0\x9f\x8f\x98','\xf0\x9f\x8f\x99','\xf0\x9f\x8f\x9a','\xf0\x9f\x8f\x9b','\xf0\x9f\x8f\x9c','\xf0\x9f\x8f\x9d','\xf0\x9f\x8f\x9e','\xf0\x9f\x8f\x9f','\xf0\x9f\x8f\xa0','\xf0\x9f\x8f\xa1','\xf0\x9f\x8f\xa2','\xf0\x9f\x8f\xa3','\xf0\x9f\x8f\xa4','\xf0\x9f\x8f\xa5','\xf0\x9f\x8f\xa6','\xf0\x9f\x8f\xa7','\xf0\x9f\x8f\xa8','\xf0\x9f\x8f\xa9','\xf0\x9f\x8f\xaa','\xf0\x9f\x8f\xab','\xf0\x9f\x8f\xac','\xf0\x9f\x8f\xad','\xf0\x9f\x8f\xae','\xf0\x9f\x8f\xaf','\xf0\x9f\x8f\xb0','\xf0\x9f\x8f\xb1','\xf0\x9f\x8f\xb2','\xf0\x9f\x8f\xb3','\xf0\x9f\x8f\xb4','\xf0\x9f\x8f\xb5','\xf0\x9f\x8f\xb6','\xf0\x9f\x8f\xb7','\xf0\x9f\x8f\xb8','\xf0\x9f\x8f\xb9','\xf0\x9f\x8f\xba','\xf0\x9f\x8f\xbb','\xf0\x9f\x8f\xbc','\xf0\x9f\x8f\xbd','\xf0\x9f\x8f\xbe','\xf0\x9f\x8f\xbf','\xf0\x9f\x90\x80','\xf0\x9f\x90\x81','\xf0\x9f\x90\x82','\xf0\x9f\x90\x83','\xf0\x9f\x90\x84','\xf0\x9f\x90\x85','\xf0\x9f\x90\x86','\xf0\x9f\x90\x87','\xf0\x9f\x90\x88','\xf0\x9f\x90\x89','\xf0\x9f\x90\x8a','\xf0\x9f\x90\x8b','\xf0\x9f\x90\x8c','\xf0\x9f\x90\x8d','\xf0\x9f\x90\x8e','\xf0\x9f\x90\x8f','\xf0\x9f\x90\x90','\xf0\x9f\x90\x91','\xf0\x9f\x90\x92','\xf0\x9f\x90\x93','\xf0\x9f\x90\x94','\xf0\x9f\x90\x95','\xf0\x9f\x90\x96','\xf0\x9f\x90\x97','\xf0\x9f\x90\x98','\xf0\x9f\x90\x99','\xf0\x9f\x90\x9a','\xf0\x9f\x90\x9b','\xf0\x9f\x90\x9c','\xf0\x9f\x90\x9d','\xf0\x9f\x90\x9e','\xf0\x9f\x90\x9f','\xf0\x9f\x90\xa0','\xf0\x9f\x90\xa1','\xf0\x9f\x90\xa2','\xf0\x9f\x90\xa3','\xf0\x9f\x90\xa4','\xf0\x9f\x90\xa5','\xf0\x9f\x90\xa6','\xf0\x9f\x90\xa7','\xf0\x9f\x90\xa8','\xf0\x9f\x90\xa9','\xf0\x9f\x90\xaa','\xf0\x9f\x90\xab','\xf0\x9f\x90\xac','\xf0\x9f\x90\xad','\xf0\x9f\x90\xae','\xf0\x9f\x90\xaf','\xf0\x9f\x90\xb0','\xf0\x9f\x90\xb1','\xf0\x9f\x90\xb2','\xf0\x9f\x90\xb3','\xf0\x9f\x90\xb4','\xf0\x9f\x90\xb5','\xf0\x9f\x90\xb6','\xf0\x9f\x90\xb7','\xf0\x9f\x90\xb8','\xf0\x9f\x90\xb9','\xf0\x9f\x90\xba','\xf0\x9f\x90\xbb','\xf0\x9f\x90\xbc','\xf0\x9f\x90\xbd','\xf0\x9f\x90\xbe','\xf0\x9f\x90\xbf','\xf0\x9f\x91\x80','\xf0\x9f\x91\x81','\xf0\x9f\x91\x82','\xf0\x9f\x91\x83','\xf0\x9f\x91\x84','\xf0\x9f\x91\x85','\xf0\x9f\x91\x86','\xf0\x9f\x91\x87','\xf0\x9f\x91\x88','\xf0\x9f\x91\x89','\xf0\x9f\x91\x8a','\xf0\x9f\x91\x8b','\xf0\x9f\x91\x8c','\xf0\x9f\x91\x8d','\xf0\x9f\x91\x8e','\xf0\x9f\x91\x8f','\xf0\x9f\x91\x90','\xf0\x9f\x91\x91','\xf0\x9f\x91\x92','\xf0\x9f\x91\x93','\xf0\x9f\x91\x94','\xf0\x9f\x91\x95','\xf0\x9f\x91\x96','\xf0\x9f\x91\x97','\xf0\x9f\x91\x98','\xf0\x9f\x91\x99','\xf0\x9f\x91\x9a','\xf0\x9f\x91\x9b','\xf0\x9f\x91\x9c','\xf0\x9f\x91\x9d','\xf0\x9f\x91\x9e','\xf0\x9f\x91\x9f','\xf0\x9f\x91\xa0','\xf0\x9f\x91\xa1','\xf0\x9f\x91\xa2','\xf0\x9f\x91\xa3','\xf0\x9f\x91\xa4','\xf0\x9f\x91\xa5','\xf0\x9f\x91\xa6','\xf0\x9f\x91\xa7','\xf0\x9f\x91\xa8','\xf0\x9f\x91\xa9','\xf0\x9f\x91\xaa','\xf0\x9f\x91\xab','\xf0\x9f\x91\xac','\xf0\x9f\x91\xad','\xf0\x9f\x91\xae','\xf0\x9f\x91\xaf','\xf0\x9f\x91\xb0','\xf0\x9f\x91\xb1','\xf0\x9f\x91\xb2','\xf0\x9f\x91\xb3','\xf0\x9f\x91\xb4','\xf0\x9f\x91\xb5','\xf0\x9f\x91\xb6','\xf0\x9f\x91\xb7','\xf0\x9f\x91\xb8','\xf0\x9f\x91\xb9','\xf0\x9f\x91\xba','\xf0\x9f\x91\xbb','\xf0\x9f\x91\xbc','\xf0\x9f\x91\xbd','\xf0\x9f\x91\xbe','\xf0\x9f\x91\xbf','\xf0\x9f\x92\x80','\xf0\x9f\x92\x81','\xf0\x9f\x92\x82','\xf0\x9f\x92\x83','\xf0\x9f\x92\x84','\xf0\x9f\x92\x85','\xf0\x9f\x92\x86','\xf0\x9f\x92\x87','\xf0\x9f\x92\x88','\xf0\x9f\x92\x89','\xf0\x9f\x92\x8a','\xf0\x9f\x92\x8b','\xf0\x9f\x92\x8c','\xf0\x9f\x92\x8d','\xf0\x9f\x92\x8e','\xf0\x9f\x92\x8f','\xf0\x9f\x92\x90','\xf0\x9f\x92\x91','\xf0\x9f\x92\x92','\xf0\x9f\x92\x93','\xf0\x9f\x92\x94','\xf0\x9f\x92\x95','\xf0\x9f\x92\x96','\xf0\x9f\x92\x97','\xf0\x9f\x92\x98','\xf0\x9f\x92\x99','\xf0\x9f\x92\x9a','\xf0\x9f\x92\x9b','\xf0\x9f\x92\x9c','\xf0\x9f\x92\x9d','\xf0\x9f\x92\x9e','\xf0\x9f\x92\x9f','\xf0\x9f\x92\xa0','\xf0\x9f\x92\xa1','\xf0\x9f\x92\xa2','\xf0\x9f\x92\xa3','\xf0\x9f\x92\xa4','\xf0\x9f\x92\xa5','\xf0\x9f\x92\xa6','\xf0\x9f\x92\xa7','\xf0\x9f\x92\xa8','\xf0\x9f\x92\xa9','\xf0\x9f\x92\xaa','\xf0\x9f\x92\xab','\xf0\x9f\x92\xac','\xf0\x9f\x92\xad','\xf0\x9f\x92\xae','\xf0\x9f\x92\xaf','\xf0\x9f\x92\xb0','\xf0\x9f\x92\xb1','\xf0\x9f\x92\xb2','\xf0\x9f\x92\xb3','\xf0\x9f\x92\xb4','\xf0\x9f\x92\xb5','\xf0\x9f\x92\xb6','\xf0\x9f\x92\xb7','\xf0\x9f\x92\xb8','\xf0\x9f\x92\xb9','\xf0\x9f\x92\xba','\xf0\x9f\x92\xbb','\xf0\x9f\x92\xbc','\xf0\x9f\x92\xbd','\xf0\x9f\x92\xbe','\xf0\x9f\x92\xbf','\xf0\x9f\x93\x80','\xf0\x9f\x93\x81','\xf0\x9f\x93\x82','\xf0\x9f\x93\x83','\xf0\x9f\x93\x84','\xf0\x9f\x93\x85','\xf0\x9f\x93\x86','\xf0\x9f\x93\x87','\xf0\x9f\x93\x88','\xf0\x9f\x93\x89','\xf0\x9f\x93\x8a','\xf0\x9f\x93\x8b','\xf0\x9f\x93\x8c','\xf0\x9f\x93\x8d','\xf0\x9f\x93\x8e','\xf0\x9f\x93\x8f','\xf0\x9f\x93\x90','\xf0\x9f\x93\x91','\xf0\x9f\x93\x92','\xf0\x9f\x93\x93','\xf0\x9f\x93\x94','\xf0\x9f\x93\x95','\xf0\x9f\x93\x96','\xf0\x9f\x93\x97','\xf0\x9f\x93\x98','\xf0\x9f\x93\x99','\xf0\x9f\x93\x9a','\xf0\x9f\x93\x9b','\xf0\x9f\x93\x9c','\xf0\x9f\x93\x9d','\xf0\x9f\x93\x9e','\xf0\x9f\x93\x9f','\xf0\x9f\x93\xa0','\xf0\x9f\x93\xa1','\xf0\x9f\x93\xa2','\xf0\x9f\x93\xa3','\xf0\x9f\x93\xa4','\xf0\x9f\x93\xa5','\xf0\x9f\x93\xa6','\xf0\x9f\x93\xa7','\xf0\x9f\x93\xa8','\xf0\x9f\x93\xa9','\xf0\x9f\x93\xaa','\xf0\x9f\x93\xab','\xf0\x9f\x93\xac','\xf0\x9f\x93\xad','\xf0\x9f\x93\xae','\xf0\x9f\x93\xaf','\xf0\x9f\x93\xb0','\xf0\x9f\x93\xb1','\xf0\x9f\x93\xb2','\xf0\x9f\x93\xb3','\xf0\x9f\x93\xb4','\xf0\x9f\x93\xb5','\xf0\x9f\x93\xb6','\xf0\x9f\x93\xb7','\xf0\x9f\x93\xb8','\xf0\x9f\x93\xb9','\xf0\x9f\x93\xba','\xf0\x9f\x93\xbb','\xf0\x9f\x93\xbc','\xf0\x9f\x93\xbd','\xf0\x9f\x93\xbe','\xf0\x9f\x93\xbf','\xf0\x9f\x94\x80','\xf0\x9f\x94\x81','\xf0\x9f\x94\x82','\xf0\x9f\x94\x83','\xf0\x9f\x94\x84','\xf0\x9f\x94\x85','\xf0\x9f\x94\x86','\xf0\x9f\x94\x87','\xf0\x9f\x94\x88','\xf0\x9f\x94\x89','\xf0\x9f\x94\x8a','\xf0\x9f\x94\x8b','\xf0\x9f\x94\x8c','\xf0\x9f\x94\x8d','\xf0\x9f\x94\x8e','\xf0\x9f\x94\x8f','\xf0\x9f\x94\x90','\xf0\x9f\x94\x91','\xf0\x9f\x94\x92','\xf0\x9f\x94\x93','\xf0\x9f\x94\x94','\xf0\x9f\x94\x95','\xf0\x9f\x94\x96','\xf0\x9f\x94\x97','\xf0\x9f\x94\x98','\xf0\x9f\x94\x99','\xf0\x9f\x94\x9a','\xf0\x9f\x94\x9b','\xf0\x9f\x94\x9c','\xf0\x9f\x94\x9d','\xf0\x9f\x94\x9e','\xf0\x9f\x94\x9f','\xf0\x9f\x94\xa0','\xf0\x9f\x94\xa1','\xf0\x9f\x94\xa2','\xf0\x9f\x94\xa3','\xf0\x9f\x94\xa4','\xf0\x9f\x94\xa5','\xf0\x9f\x94\xa6','\xf0\x9f\x94\xa7','\xf0\x9f\x94\xa8','\xf0\x9f\x94\xa9','\xf0\x9f\x94\xaa','\xf0\x9f\x94\xab','\xf0\x9f\x94\xac','\xf0\x9f\x94\xad','\xf0\x9f\x94\xae','\xf0\x9f\x94\xaf','\xf0\x9f\x94\xb0','\xf0\x9f\x94\xb1','\xf0\x9f\x94\xb2','\xf0\x9f\x94\xb3','\xf0\x9f\x94\xb4','\xf0\x9f\x94\xb5','\xf0\x9f\x94\xb6','\xf0\x9f\x94\xb7','\xf0\x9f\x94\xb8','\xf0\x9f\x94\xb9','\xf0\x9f\x94\xba','\xf0\x9f\x94\xbb','\xf0\x9f\x94\xbc','\xf0\x9f\x94\xbd','\xf0\x9f\x94\xbe','\xf0\x9f\x94\xbf','\xf0\x9f\x95\x80','\xf0\x9f\x95\x81','\xf0\x9f\x95\x82','\xf0\x9f\x95\x83','\xf0\x9f\x95\x84','\xf0\x9f\x95\x85','\xf0\x9f\x95\x86','\xf0\x9f\x95\x87','\xf0\x9f\x95\x88','\xf0\x9f\x95\x89','\xf0\x9f\x95\x8a','\xf0\x9f\x95\x8b','\xf0\x9f\x95\x8c','\xf0\x9f\x95\x8d','\xf0\x9f\x95\x8e','\xf0\x9f\x95\x8f','\xf0\x9f\x95\x90','\xf0\x9f\x95\x91','\xf0\x9f\x95\x92','\xf0\x9f\x95\x93','\xf0\x9f\x95\x94','\xf0\x9f\x95\x95','\xf0\x9f\x95\x96','\xf0\x9f\x95\x97','\xf0\x9f\x95\x98','\xf0\x9f\x95\x99','\xf0\x9f\x95\x9a','\xf0\x9f\x95\x9b','\xf0\x9f\x95\x9c','\xf0\x9f\x95\x9d','\xf0\x9f\x95\x9e','\xf0\x9f\x95\x9f','\xf0\x9f\x95\xa0','\xf0\x9f\x95\xa1','\xf0\x9f\x95\xa2','\xf0\x9f\x95\xa3','\xf0\x9f\x95\xa4','\xf0\x9f\x95\xa5','\xf0\x9f\x95\xa6','\xf0\x9f\x95\xa7','\xf0\x9f\x95\xa8','\xf0\x9f\x95\xa9','\xf0\x9f\x95\xaa','\xf0\x9f\x95\xab','\xf0\x9f\x95\xac','\xf0\x9f\x95\xad','\xf0\x9f\x95\xae','\xf0\x9f\x95\xaf','\xf0\x9f\x95\xb0','\xf0\x9f\x95\xb1','\xf0\x9f\x95\xb2','\xf0\x9f\x95\xb3','\xf0\x9f\x95\xb4','\xf0\x9f\x95\xb5','\xf0\x9f\x95\xb6','\xf0\x9f\x95\xb7','\xf0\x9f\x95\xb8','\xf0\x9f\x95\xb9','\xf0\x9f\x95\xba','\xf0\x9f\x95\xbb','\xf0\x9f\x95\xbc','\xf0\x9f\x95\xbd','\xf0\x9f\x95\xbe','\xf0\x9f\x95\xbf','\xf0\x9f\x96\x80','\xf0\x9f\x96\x81','\xf0\x9f\x96\x82','\xf0\x9f\x96\x83','\xf0\x9f\x96\x84','\xf0\x9f\x96\x85','\xf0\x9f\x96\x86','\xf0\x9f\x96\x87','\xf0\x9f\x96\x88','\xf0\x9f\x96\x89','\xf0\x9f\x96\x8a','\xf0\x9f\x96\x8b','\xf0\x9f\x96\x8c','\xf0\x9f\x96\x8d','\xf0\x9f\x96\x8e','\xf0\x9f\x96\x8f','\xf0\x9f\x96\x90','\xf0\x9f\x96\x91','\xf0\x9f\x96\x92','\xf0\x9f\x96\x93','\xf0\x9f\x96\x94','\xf0\x9f\x96\x95','\xf0\x9f\x96\x96','\xf0\x9f\x96\x97','\xf0\x9f\x96\x98','\xf0\x9f\x96\x99','\xf0\x9f\x96\x9a','\xf0\x9f\x96\x9b','\xf0\x9f\x96\x9c','\xf0\x9f\x96\x9d','\xf0\x9f\x96\x9e','\xf0\x9f\x96\x9f','\xf0\x9f\x96\xa0','\xf0\x9f\x96\xa1','\xf0\x9f\x96\xa2','\xf0\x9f\x96\xa3','\xf0\x9f\x96\xa4','\xf0\x9f\x96\xa5','\xf0\x9f\x96\xa6','\xf0\x9f\x96\xa7','\xf0\x9f\x96\xa8','\xf0\x9f\x96\xa9','\xf0\x9f\x96\xaa','\xf0\x9f\x96\xab','\xf0\x9f\x96\xac','\xf0\x9f\x96\xad','\xf0\x9f\x96\xae','\xf0\x9f\x96\xaf','\xf0\x9f\x96\xb0','\xf0\x9f\x96\xb1','\xf0\x9f\x96\xb2','\xf0\x9f\x96\xb3','\xf0\x9f\x96\xb4','\xf0\x9f\x96\xb5','\xf0\x9f\x96\xb6','\xf0\x9f\x96\xb7','\xf0\x9f\x96\xb8','\xf0\x9f\x96\xb9','\xf0\x9f\x96\xba','\xf0\x9f\x96\xbb','\xf0\x9f\x96\xbc','\xf0\x9f\x96\xbd','\xf0\x9f\x96\xbe','\xf0\x9f\x96\xbf','\xf0\x9f\x97\x80','\xf0\x9f\x97\x81','\xf0\x9f\x97\x82','\xf0\x9f\x97\x83','\xf0\x9f\x97\x84','\xf0\x9f\x97\x85','\xf0\x9f\x97\x86','\xf0\x9f\x97\x87','\xf0\x9f\x97\x88','\xf0\x9f\x97\x89','\xf0\x9f\x97\x8a','\xf0\x9f\x97\x8b','\xf0\x9f\x97\x8c','\xf0\x9f\x97\x8d','\xf0\x9f\x97\x8e','\xf0\x9f\x97\x8f','\xf0\x9f\x97\x90','\xf0\x9f\x97\x91','\xf0\x9f\x97\x92','\xf0\x9f\x97\x93','\xf0\x9f\x97\x94','\xf0\x9f\x97\x95','\xf0\x9f\x97\x96','\xf0\x9f\x97\x97','\xf0\x9f\x97\x98','\xf0\x9f\x97\x99','\xf0\x9f\x97\x9a','\xf0\x9f\x97\x9b','\xf0\x9f\x97\x9c','\xf0\x9f\x97\x9d','\xf0\x9f\x97\x9e','\xf0\x9f\x97\x9f','\xf0\x9f\x97\xa0','\xf0\x9f\x97\xa1','\xf0\x9f\x97\xa2','\xf0\x9f\x97\xa3','\xf0\x9f\x97\xa4','\xf0\x9f\x97\xa5','\xf0\x9f\x97\xa6','\xf0\x9f\x97\xa7','\xf0\x9f\x97\xa8','\xf0\x9f\x97\xa9','\xf0\x9f\x97\xaa','\xf0\x9f\x97\xab','\xf0\x9f\x97\xac','\xf0\x9f\x97\xad','\xf0\x9f\x97\xae','\xf0\x9f\x97\xaf','\xf0\x9f\x97\xb0','\xf0\x9f\x97\xb1','\xf0\x9f\x97\xb2','\xf0\x9f\x97\xb3','\xf0\x9f\x97\xb4','\xf0\x9f\x97\xb5','\xf0\x9f\x97\xb6','\xf0\x9f\x97\xb7','\xf0\x9f\x97\xb8','\xf0\x9f\x97\xb9','\xf0\x9f\x97\xba','\xf0\x9f\x97\xbb','\xf0\x9f\x97\xbc','\xf0\x9f\x97\xbd','\xf0\x9f\x97\xbe','\xf0\x9f\x97\xbf','\xf0\x9f\x98\x80','\xf0\x9f\x98\x81','\xf0\x9f\x98\x82','\xf0\x9f\x98\x83','\xf0\x9f\x98\x84','\xf0\x9f\x98\x85','\xf0\x9f\x98\x86','\xf0\x9f\x98\x87','\xf0\x9f\x98\x88','\xf0\x9f\x98\x89','\xf0\x9f\x98\x8a','\xf0\x9f\x98\x8b','\xf0\x9f\x98\x8c','\xf0\x9f\x98\x8d','\xf0\x9f\x98\x8e','\xf0\x9f\x98\x8f','\xf0\x9f\x98\x90','\xf0\x9f\x98\x91','\xf0\x9f\x98\x92','\xf0\x9f\x98\x93','\xf0\x9f\x98\x94','\xf0\x9f\x98\x95','\xf0\x9f\x98\x96','\xf0\x9f\x98\x97','\xf0\x9f\x98\x98','\xf0\x9f\x98\x99','\xf0\x9f\x98\x9a','\xf0\x9f\x98\x9b','\xf0\x9f\x98\x9c','\xf0\x9f\x98\x9d','\xf0\x9f\x98\x9e','\xf0\x9f\x98\x9f','\xf0\x9f\x98\xa0','\xf0\x9f\x98\xa1','\xf0\x9f\x98\xa2','\xf0\x9f\x98\xa3','\xf0\x9f\x98\xa4','\xf0\x9f\x98\xa5','\xf0\x9f\x98\xa6','\xf0\x9f\x98\xa7','\xf0\x9f\x98\xa8','\xf0\x9f\x98\xa9','\xf0\x9f\x98\xaa','\xf0\x9f\x98\xab','\xf0\x9f\x98\xac','\xf0\x9f\x98\xad','\xf0\x9f\x98\xae','\xf0\x9f\x98\xaf','\xf0\x9f\x98\xb0','\xf0\x9f\x98\xb1','\xf0\x9f\x98\xb2','\xf0\x9f\x98\xb3','\xf0\x9f\x98\xb4','\xf0\x9f\x98\xb5','\xf0\x9f\x98\xb6','\xf0\x9f\x98\xb7','\xf0\x9f\x98\xb8','\xf0\x9f\x98\xb9','\xf0\x9f\x98\xba','\xf0\x9f\x98\xbb','\xf0\x9f\x98\xbc','\xf0\x9f\x98\xbd','\xf0\x9f\x98\xbe','\xf0\x9f\x98\xbf','\xf0\x9f\x99\x80','\xf0\x9f\x99\x81','\xf0\x9f\x99\x82','\xf0\x9f\x99\x83','\xf0\x9f\x99\x84','\xf0\x9f\x99\x85','\xf0\x9f\x99\x86','\xf0\x9f\x99\x87','\xf0\x9f\x99\x88','\xf0\x9f\x99\x89','\xf0\x9f\x99\x8a','\xf0\x9f\x99\x8b','\xf0\x9f\x99\x8c','\xf0\x9f\x99\x8d','\xf0\x9f\x99\x8e','\xf0\x9f\x99\x8f','\xf0\x9f\x99\x90','\xf0\x9f\x99\x91','\xf0\x9f\x99\x92','\xf0\x9f\x99\x93','\xf0\x9f\x99\x94','\xf0\x9f\x99\x95','\xf0\x9f\x99\x96','\xf0\x9f\x99\x97','\xf0\x9f\x99\x98','\xf0\x9f\x99\x99','\xf0\x9f\x99\x9a','\xf0\x9f\x99\x9b','\xf0\x9f\x99\x9c','\xf0\x9f\x99\x9d','\xf0\x9f\x99\x9e','\xf0\x9f\x99\x9f','\xf0\x9f\x99\xa0','\xf0\x9f\x99\xa1','\xf0\x9f\x99\xa2','\xf0\x9f\x99\xa3','\xf0\x9f\x99\xa4','\xf0\x9f\x99\xa5','\xf0\x9f\x99\xa6','\xf0\x9f\x99\xa7','\xf0\x9f\x99\xa8','\xf0\x9f\x99\xa9','\xf0\x9f\x99\xaa','\xf0\x9f\x99\xab','\xf0\x9f\x99\xac','\xf0\x9f\x99\xad','\xf0\x9f\x99\xae','\xf0\x9f\x99\xaf','\xf0\x9f\x99\xb0','\xf0\x9f\x99\xb1','\xf0\x9f\x99\xb2','\xf0\x9f\x99\xb3','\xf0\x9f\x99\xb4','\xf0\x9f\x99\xb5','\xf0\x9f\x99\xb6','\xf0\x9f\x99\xb7','\xf0\x9f\x99\xb8','\xf0\x9f\x99\xb9','\xf0\x9f\x99\xba','\xf0\x9f\x99\xbb','\xf0\x9f\x99\xbc','\xf0\x9f\x99\xbd','\xf0\x9f\x99\xbe','\xf0\x9f\x99\xbf','\xf0\x9f\x9a\x80','\xf0\x9f\x9a\x81','\xf0\x9f\x9a\x82','\xf0\x9f\x9a\x83','\xf0\x9f\x9a\x84','\xf0\x9f\x9a\x85','\xf0\x9f\x9a\x86','\xf0\x9f\x9a\x87','\xf0\x9f\x9a\x88','\xf0\x9f\x9a\x89','\xf0\x9f\x9a\x8a','\xf0\x9f\x9a\x8b','\xf0\x9f\x9a\x8c','\xf0\x9f\x9a\x8d','\xf0\x9f\x9a\x8e','\xf0\x9f\x9a\x8f','\xf0\x9f\x9a\x90','\xf0\x9f\x9a\x91','\xf0\x9f\x9a\x92','\xf0\x9f\x9a\x93','\xf0\x9f\x9a\x94','\xf0\x9f\x9a\x95','\xf0\x9f\x9a\x96','\xf0\x9f\x9a\x97','\xf0\x9f\x9a\x98','\xf0\x9f\x9a\x99','\xf0\x9f\x9a\x9a','\xf0\x9f\x9a\x9b','\xf0\x9f\x9a\x9c','\xf0\x9f\x9a\x9d','\xf0\x9f\x9a\x9e','\xf0\x9f\x9a\x9f','\xf0\x9f\x9a\xa0','\xf0\x9f\x9a\xa1','\xf0\x9f\x9a\xa2','\xf0\x9f\x9a\xa3','\xf0\x9f\x9a\xa4','\xf0\x9f\x9a\xa5','\xf0\x9f\x9a\xa6','\xf0\x9f\x9a\xa7','\xf0\x9f\x9a\xa8','\xf0\x9f\x9a\xa9','\xf0\x9f\x9a\xaa','\xf0\x9f\x9a\xab','\xf0\x9f\x9a\xac','\xf0\x9f\x9a\xad','\xf0\x9f\x9a\xae','\xf0\x9f\x9a\xaf','\xf0\x9f\x9a\xb0','\xf0\x9f\x9a\xb1','\xf0\x9f\x9a\xb2','\xf0\x9f\x9a\xb3','\xf0\x9f\x9a\xb4','\xf0\x9f\x9a\xb5','\xf0\x9f\x9a\xb6','\xf0\x9f\x9a\xb7','\xf0\x9f\x9a\xb8','\xf0\x9f\x9a\xb9','\xf0\x9f\x9a\xba','\xf0\x9f\x9a\xbb','\xf0\x9f\x9a\xbc','\xf0\x9f\x9a\xbd','\xf0\x9f\x9a\xbe','\xf0\x9f\x9a\xbf','\xf0\x9f\x9b\x80','\xf0\x9f\x9b\x81','\xf0\x9f\x9b\x82','\xf0\x9f\x9b\x83','\xf0\x9f\x9b\x84','\xf0\x9f\x9b\x85','\xf0\x9f\x9b\x86','\xf0\x9f\x9b\x87','\xf0\x9f\x9b\x88','\xf0\x9f\x9b\x89','\xf0\x9f\x9b\x8a','\xf0\x9f\x9b\x8b','\xf0\x9f\x9b\x8c','\xf0\x9f\x9b\x8d','\xf0\x9f\x9b\x8e','\xf0\x9f\x9b\x8f','\xf0\x9f\x9b\x90','\xf0\x9f\x9b\x91','\xf0\x9f\x9b\x92','\xf0\x9f\x9b\x93','\xf0\x9f\x9b\x94','\xf0\x9f\x9b\x95','\xf0\x9f\x9b\x96','\xf0\x9f\x9b\x97','\xf0\x9f\x9b\x98','\xf0\x9f\x9b\x99','\xf0\x9f\x9b\x9a','\xf0\x9f\x9b\x9b','\xf0\x9f\x9b\x9c','\xf0\x9f\x9b\x9d','\xf0\x9f\x9b\x9e','\xf0\x9f\x9b\x9f','\xf0\x9f\x9b\xa0','\xf0\x9f\x9b\xa1','\xf0\x9f\x9b\xa2','\xf0\x9f\x9b\xa3','\xf0\x9f\x9b\xa4','\xf0\x9f\x9b\xa5','\xf0\x9f\x9b\xa6','\xf0\x9f\x9b\xa7','\xf0\x9f\x9b\xa8','\xf0\x9f\x9b\xa9','\xf0\x9f\x9b\xaa','\xf0\x9f\x9b\xab','\xf0\x9f\x9b\xac','\xf0\x9f\x9b\xad','\xf0\x9f\x9b\xae','\xf0\x9f\x9b\xaf','\xf0\x9f\x9b\xb0','\xf0\x9f\x9b\xb1','\xf0\x9f\x9b\xb2','\xf0\x9f\x9b\xb3','\xf0\x9f\x9b\xb4','\xf0\x9f\x9b\xb5','\xf0\x9f\x9b\xb6','\xf0\x9f\x9b\xb7','\xf0\x9f\x9b\xb8','\xf0\x9f\x9b\xb9','\xf0\x9f\x9b\xba','\xf0\x9f\x9b\xbb','\xf0\x9f\x9b\xbc','\xf0\x9f\x9b\xbd','\xf0\x9f\x9b\xbe','\xf0\x9f\x9b\xbf','\xf0\x9f\x9c\x80','\xf0\x9f\x9c\x81','\xf0\x9f\x9c\x82','\xf0\x9f\x9c\x83','\xf0\x9f\x9c\x84','\xf0\x9f\x9c\x85','\xf0\x9f\x9c\x86','\xf0\x9f\x9c\x87','\xf0\x9f\x9c\x88','\xf0\x9f\x9c\x89','\xf0\x9f\x9c\x8a','\xf0\x9f\x9c\x8b','\xf0\x9f\x9c\x8c','\xf0\x9f\x9c\x8d','\xf0\x9f\x9c\x8e','\xf0\x9f\x9c\x8f','\xf0\x9f\x9c\x90','\xf0\x9f\x9c\x91','\xf0\x9f\x9c\x92','\xf0\x9f\x9c\x93','\xf0\x9f\x9c\x94','\xf0\x9f\x9c\x95','\xf0\x9f\x9c\x96','\xf0\x9f\x9c\x97','\xf0\x9f\x9c\x98','\xf0\x9f\x9c\x99','\xf0\x9f\x9c\x9a','\xf0\x9f\x9c\x9b','\xf0\x9f\x9c\x9c','\xf0\x9f\x9c\x9d','\xf0\x9f\x9c\x9e','\xf0\x9f\x9c\x9f','\xf0\x9f\x9c\xa0','\xf0\x9f\x9c\xa1','\xf0\x9f\x9c\xa2','\xf0\x9f\x9c\xa3','\xf0\x9f\x9c\xa4','\xf0\x9f\x9c\xa5','\xf0\x9f\x9c\xa6','\xf0\x9f\x9c\xa7','\xf0\x9f\x9c\xa8','\xf0\x9f\x9c\xa9','\xf0\x9f\x9c\xaa','\xf0\x9f\x9c\xab','\xf0\x9f\x9c\xac','\xf0\x9f\x9c\xad','\xf0\x9f\x9c\xae','\xf0\x9f\x9c\xaf','\xf0\x9f\x9c\xb0','\xf0\x9f\x9c\xb1','\xf0\x9f\x9c\xb2','\xf0\x9f\x9c\xb3','\xf0\x9f\x9c\xb4','\xf0\x9f\x9c\xb5','\xf0\x9f\x9c\xb6','\xf0\x9f\x9c\xb7','\xf0\x9f\x9c\xb8','\xf0\x9f\x9c\xb9','\xf0\x9f\x9c\xba','\xf0\x9f\x9c\xbb','\xf0\x9f\x9c\xbc','\xf0\x9f\x9c\xbd','\xf0\x9f\x9c\xbe','\xf0\x9f\x9c\xbf'}
#def remove_stopwords(text):
#    text = [word for word in text if word not in emojis]
#    return text
#df['content'] = df['content'].apply(lambda x: remove_stopwords(x))
#df.to_csv(r'D:\master\data science\semestre 4\M2.979 - tfm\data\raw_influencers_test_02.csv', index=False, header=True)






#stop_words = set(stopwords.words('english'))
#print(stop_words)




#df['content'] = df['content'].apply(ast.literal_eval).str.decode('utf-8')
#df.to_csv(r'D:\master\data science\semestre 4\M2.979 - tfm\data\raw_influencers_test_01.csv', index=False, header=True)

# Remove punctuation
#df['content'] = df['content'].apply(lambda x:''.join([i for i in x
#                                                  if i not in string.punctuation]))
#df.to_csv(r'D:\master\data science\semestre 4\M2.979 - tfm\data\raw_influencers_test_00.csv', index = False, header=True)

# Remove numbers
#df.poem = df.poem.apply(lambda x: x.translate(None, string.digits))
#df.to_csv(r'D:\master\data science\semestre 4\M2.979 - tfm\data\raw_influencers_test_01.csv', index = False, header=True)

# Convert the titles to lowercase
#df['content'] = df['content'].map(lambda x: x.lower())
#df.to_csv(r'D:\master\data science\semestre 4\M2.979 - tfm\data\raw_influencers_test_02.csv', index = False, header=True)